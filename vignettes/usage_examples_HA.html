<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Hyowon An and Justin T. Landis" />

<meta name="date" content="2018-03-16" />

<title>R package dr4pl usage examples</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">R package dr4pl usage examples</h1>
<h4 class="author"><em>Hyowon An and Justin T. Landis</em></h4>
<h4 class="date"><em>2018-03-16</em></h4>



<div id="installing-packages" class="section level2">
<h2>Installing packages</h2>
<p>Our R package <strong>dr4pl</strong> is now available on CRAN! You can download it by the command <strong>install.packages(“dr4pl”)</strong>. Note that the argument <strong>repos</strong> can be omitted. Let us now load R packages that we need to use in our examples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(drc)
<span class="kw">library</span>(dr4pl)
<span class="kw">library</span>(ggplot2)</code></pre></div>
<p><strong>dr4pl</strong> is an abbreviation for <strong>D</strong>ose-<strong>R</strong>esponse data analysis using <strong>4</strong> <strong>P</strong>arameter <strong>L</strong>ogistic (4PL) model. 4PL models are typically used models in pharmacological and toxicological experiments.</p>
</div>
<div id="errors-drawn-by-the-r-package-drc" class="section level2">
<h2>Errors drawn by the R package ‘drc’</h2>
<p>The most well-known R package for dose-response modelling is <strong>drc</strong>. However, that R package has drawn errors in many data sets generated by Dittmer Lab. Let’s first consider the first error case <strong>drc_error_1</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(drc_error_<span class="dv">1</span>)</code></pre></div>
<pre><code>##   Dose Response
## 1    1        0
## 2    1       26
## 3    1       12
## 4    1        0
## 5    1       48
## 6    1       21</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(drc_error_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> Dose, <span class="dt">y =</span> Response)) <span class="op">+</span><span class="st">  </span><span class="co"># Data name, variable names</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st">  </span><span class="co"># Put data points on the scatter plot</span>
<span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span><span class="st">  </span><span class="co"># Change the x-axis scale to log 10 scale</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Error Case 1&quot;</span>)  <span class="co"># Set the title</span></code></pre></div>
<p>As you can see, this data set contains an extreme outlier at the dosage level 1e-05. These outliers are often generated by measurement errors or experimental failure. If you were to fit a 4PL model with <strong>drc</strong>, you would recieve the following.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tryCatch</span>({
  <span class="kw">drm</span>(Response<span class="op">~</span>Dose, <span class="dt">data =</span> drc_error_<span class="dv">1</span>, <span class="dt">fct =</span> <span class="kw">LL.4</span>())
},
<span class="dt">warning =</span> <span class="cf">function</span>(war) {
  <span class="co"># warning handler picks up where error was generated</span>
  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, war))
},
<span class="dt">error =</span> <span class="cf">function</span>(err) {
  <span class="co"># error handler picks up where error was generated</span>
  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, err))
})</code></pre></div>
<pre><code>## [1] &quot;simpleWarning in log(dose/parmMat[, 4]): NaNs produced\n&quot;</code></pre>
<p>Note that the error message just indicates convergence failure without explanation about the reasons. Instead of giving up, you can try to use <strong>dr4pl</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.error.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">dr4pl</span>(Response<span class="op">~</span>Dose, <span class="dt">data =</span> drc_error_<span class="dv">1</span>)

<span class="kw">plot</span>(dr4pl.error.<span class="dv">1</span>, <span class="dt">text.title =</span> <span class="st">&quot;Error plot #1&quot;</span>)</code></pre></div>
<p>The fitted curve does not look bad. Unlike <strong>drc</strong>, convergence failure does not draw an error but presents FALSE value in an indicator variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.error.<span class="dv">1</span><span class="op">$</span>convergence  <span class="co"># FALSE indicates convergence failure</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Once convergence failure happens, <strong>dr4pl</strong> returns a child object which is obtained by robust estimation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.robust.<span class="dv">1</span> &lt;-<span class="st"> </span>dr4pl.error.<span class="dv">1</span><span class="op">$</span>dr4pl.robust
<span class="kw">class</span>(dr4pl.error.<span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] &quot;dr4pl&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(dr4pl.robust.<span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] &quot;dr4pl&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.robust.<span class="dv">1</span><span class="op">$</span>convergence</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The parent object <em>dr4pl.error.1</em> and the child object <em>dr4pl.robust.1</em> have the same class <em>dr4pl</em>. Note that the child object <em>dr4pl.robust.1</em> indicates that convergence failure did not happen when robust estimation is applied. In the following diagnosis plot, outliers are denoted by red triangles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dr4pl.robust.<span class="dv">1</span>, <span class="dt">indices.outlier =</span> dr4pl.robust.<span class="dv">1</span><span class="op">$</span>idx.outlier)</code></pre></div>
<p>Let’s next consider the second error case <strong>drc_error_2</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(drc_error_<span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">x =</span> Dose, <span class="dt">y =</span> Response)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Error Case 2&quot;</span>)</code></pre></div>
<p>The most important problem with Error Case 2 is that whether its trend is decreasing or increasing is ambiguous. <strong>dr4pl</strong>’s default parameter <em>trend</em> automizes this and will find the best fit based on optimization. Let us see how this example plays out with the data set <strong>drc_error_2</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.error.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">dr4pl</span>(Response<span class="op">~</span>Dose, <span class="dt">data =</span> drc_error_<span class="dv">2</span>, <span class="dt">method.init =</span> <span class="st">&quot;logistic&quot;</span>)
<span class="kw">plot</span>(dr4pl.error.<span class="dv">2</span>, <span class="dt">text.title =</span> <span class="st">&quot;Trend is default&quot;</span>)</code></pre></div>
<p>The parameter <em>trend</em> helps force the fit to either <em>increasing</em> or <em>decreasing</em> in the event that you are confident that your response follows that trend. We may choose to force a decreasing curve, with other apporpriate parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.error.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">dr4pl</span>(Response<span class="op">~</span>Dose, <span class="dt">data =</span> drc_error_<span class="dv">2</span>, <span class="dt">trend =</span> <span class="st">&quot;decreasing&quot;</span>, <span class="dt">method.init =</span> <span class="st">&quot;logistic&quot;</span>, <span class="dt">method.robust =</span> <span class="st">&quot;absolute&quot;</span>)
<span class="kw">plot</span>(dr4pl.error.<span class="dv">2</span>, <span class="dt">text.title =</span> <span class="st">&quot;Trend forced to decrease&quot;</span>)</code></pre></div>
<p>Note that the fit now is decreasing. Let’s consider the data set <strong>drc_error_4</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(drc_error_<span class="dv">4</span>, <span class="kw">aes</span>(<span class="dt">x =</span> Dose, <span class="dt">y =</span> Response)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;drc_error_4&quot;</span>)</code></pre></div>
<p>This data set has two outliers in the largest dosage level. This data set also exemplifies the <strong>support problem</strong> as well. A <strong>support problem</strong> indicates that a data set does not have enough data points on the right side of the IC50 parameter. This can result in difficulty in sometimes obtaining estimates of the lower asymptote and slope and sometimes even convergence failure. Let’s try to apply <strong>drc</strong> to this data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tryCatch</span>({
  <span class="kw">drm</span>(Response<span class="op">~</span>Dose, <span class="dt">data =</span> drc_error_<span class="dv">4</span>, <span class="dt">fct =</span> <span class="kw">LL.4</span>())
},
<span class="dt">warning =</span> <span class="cf">function</span>(war) {
  <span class="co"># warning handler picks up where error was generated</span>
  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, war))
},
<span class="dt">error =</span> <span class="cf">function</span>(err) {
  <span class="co"># error handler picks up where error was generated</span>
  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, err))
})</code></pre></div>
<pre><code>## [1] &quot;simpleWarning in log(dose/parmMat[, 4]): NaNs produced\n&quot;</code></pre>
<p>As expected, <strong>drc</strong> is not able to fit a 4PL model to <em>drc_error_4</em>. Now let’s use <strong>dr4pl</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.error.<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">dr4pl</span>(Response<span class="op">~</span>Dose, <span class="dt">data =</span> drc_error_<span class="dv">4</span>, <span class="dt">method.init =</span> <span class="st">&quot;logistic&quot;</span>)
dr4pl.error.<span class="dv">4</span><span class="op">$</span>convergence</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dr4pl.error.<span class="dv">4</span>, <span class="dt">text.title =</span> <span class="st">&quot;Error plot #4&quot;</span>)</code></pre></div>
<p>The package drc draws errors with each one of these cases. However dr4pl is able generate a curve despite outliers and a support problem in each error case. In each case we were able to modify the title and axis names with <em>text.title</em>, <em>text.x</em>, or <em>text.y</em>. We are also able to bring attention to outlier points by passing a vector of the indices to the <em>indices.outlier</em> argument.</p>
</div>
<div id="robust-estimation" class="section level2">
<h2>Robust Estimation</h2>
<p><strong>dr4pl</strong> provides several methods of robust estimation. Consider you want to plot the dr4pl data set <strong>sample_data_5</strong>. Let’s try and apply the default parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.Mead.<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">dr4pl</span>(Response<span class="op">~</span>Dose, <span class="dt">data =</span> sample_data_<span class="dv">5</span>)
<span class="kw">plot</span>(dr4pl.Mead.<span class="dv">5</span>, <span class="dt">text.title =</span> <span class="st">&quot;Fit with Mead's method&quot;</span>)</code></pre></div>
<p>After producing a plot with the default parameters, you may be confident in producing a better fit with other parameters. This is where the arguments <em>method.init</em> and <em>method.robust</em> come into play, which you may have noticed that these arguments where used in the error case examples. The default paramter to <em>method.init</em> is <em>Mead</em>. This uses Mead’s method when approximating the theta parameters. The alternative to using Mead’s method is <em>logistic</em>, which uses a logistic method to obtain initial parameter estimates. Let’s see how our plot will change when we use the logistic method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.logistic.<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">dr4pl</span>(Response<span class="op">~</span>Dose, <span class="dt">data =</span> sample_data_<span class="dv">5</span>, <span class="dt">method.init =</span> <span class="st">&quot;logistic&quot;</span>)
<span class="kw">plot</span>(dr4pl.logistic.<span class="dv">5</span>, <span class="dt">text.title =</span> <span class="st">&quot;Fit with the logistic method&quot;</span>)</code></pre></div>
<p>Mead’s method seems to generate tighter fit with this data set. This is due to a characteristic of Mead’s method that it focuses more on the slope and lower asymptote parameters than the logistic method.</p>
<p>Now let’s talk about <em>method.robust</em>. <em>method.robust</em> allows the user to choose the loss function used during optimization. The default loss function used is the squared loss function. The user has three other loss functions to select from: <em>absolute</em>, <em>Huber</em>, and <em>Tukey</em>. Lets see how this plot will change when using <em>absolute</em> versus <em>Tukey</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.absolute.<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">dr4pl</span>(Response<span class="op">~</span>Dose, <span class="dt">data =</span> sample_data_<span class="dv">5</span>, <span class="dt">method.robust =</span> <span class="st">&quot;absolute&quot;</span>)
<span class="kw">plot</span>(dr4pl.absolute.<span class="dv">5</span>, <span class="dt">text.title =</span> <span class="st">&quot;Fit with the absolute loss&quot;</span>)

dr4pl.Tukey.<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">dr4pl</span>(Response<span class="op">~</span>Dose, <span class="dt">data =</span> sample_data_<span class="dv">5</span>, <span class="dt">method.robust =</span> <span class="st">&quot;Tukey&quot;</span>)
<span class="kw">plot</span>(dr4pl.Tukey.<span class="dv">5</span>, <span class="dt">text.title =</span> <span class="st">&quot;Fit with Tukey's biweight loss&quot;</span>)</code></pre></div>
<p>When selecting <em>Tukey</em> for the argument <strong>method.robust</strong>, the generated fit is less weighted by the largest dosage level which is an outlier response of zero. When selecting <em>absolute</em> for the argument <strong>method.robust</strong>, the generated fit is more weignted by the largest dosage level. It may take several attempts to find the best parameters for each data set.</p>
</div>
<div id="other-functionalities-of-dr4pl" class="section level2">
<h2>Other functionalities of dr4pl</h2>
<p>Let’s look at other uses for this code. Consider the following data set <strong>sample_data_3</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">dr4pl</span>(Response<span class="op">~</span>Dose, <span class="dt">data =</span> sample_data_<span class="dv">3</span>)
<span class="kw">plot</span>(dr4pl.<span class="dv">3</span>, <span class="dt">text.title =</span> <span class="st">&quot;Sample data #3&quot;</span>)</code></pre></div>
<p>Once you produce a curve you feel is representative of your data, you may get the parameters of the curve by using the summary function on the dr4pl variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">summary.dr4pl.<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">summary</span>(dr4pl.<span class="dv">3</span>)
summary.dr4pl.<span class="dv">3</span><span class="op">$</span>coefficients</code></pre></div>
<pre><code>##                 Estimate       StdErr    t.value       p.value
## UpperLimit 59858.0700193 1.328219e-01 450664.044 3.940157e-177
## IC50           5.0794918 1.531608e-05 331644.346 2.454736e-172
## Slope         -0.6117371 1.440712e-05 -42460.740 3.362528e-140
## LowerLimit   980.8205686 1.354448e-01   7241.477 1.515083e-112</code></pre>
<p>It is possible that you are interested in more than just the IC50 variable. Use the IC() function to produce the respective dose values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">values &lt;-<span class="st"> </span><span class="kw">IC</span>(dr4pl.<span class="dv">3</span>, <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">70</span>, <span class="dv">90</span>))
values</code></pre></div>
<pre><code>## InhibPercent:10 InhibPercent:30 InhibPercent:50 InhibPercent:70 
##     184.3784198      20.2930770       5.0794918       1.2714305 
## InhibPercent:90 
##       0.1399363</code></pre>
<p>Finally, you can easily edit your plot further with basic ggplot2 additional controls. Let’s see how <strong>dr4pl</strong> handles the data set <strong>chekcweed0</strong> in <strong>drc</strong>. As can be seen in the figure, a user can set the x-axis and y-axis labels and also the x-axis tick labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dr4pl.chickweed &lt;-<span class="st"> </span><span class="kw">dr4pl</span>(count<span class="op">~</span>time, <span class="dt">data =</span> chickweed0, <span class="dt">trend =</span> <span class="st">&quot;increasing&quot;</span>)
<span class="kw">plot</span>(dr4pl.chickweed, <span class="dt">text.x =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">text.y =</span> <span class="st">&quot;Count&quot;</span>, <span class="dt">text.title =</span> <span class="st">&quot;Dataset chickweed0&quot;</span>, <span class="dt">breaks.x =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">175</span>, <span class="dv">250</span>))</code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
